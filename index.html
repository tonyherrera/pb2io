<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>pb2.io ‚Äî punks on billboards, worldwide</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Mono:ital,wght@0,300;0,400;0,500;1,300&family=Bebas+Neue&family=Space+Mono:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  /* ‚îÄ‚îÄ DARK THEME (default) ‚îÄ‚îÄ */
  :root {
    --bg: #0a0a0a;
    --surface: #111;
    --border: #1e1e1e;
    --border-subtle: #161616;
    --accent: #ff3c00;
    --text: #d4d4d4;
    --text-strong: #eeeeee;
    --dim: #555;
    --dim2: #333;
    --map-bg: #0d1117;
    --map-land: #151c25;
    --map-land-stroke: #1e2a36;
    --map-grid: #1a1a1a;
    --green: #00cc70;
    --green-glow: #00ff88;
    --nav-bg: rgba(10,10,10,0.92);
    --billboard-bg: #111;
    --billboard-border: #2a2a2a;
    --poe-bg: #0d0d0d;
    --feed-hover: #161616;
    --feed-selected: #1a1a1a;
    --thumb-border: #222;
    --scrollbar: #222;
    --big-label-color: #1e1e1e;
    --overlay-title: #222;
    --logo-color: #fff;
  }

  /* ‚îÄ‚îÄ LIGHT THEME ‚îÄ‚îÄ */
  html.light {
    --bg: #f0ede8;
    --surface: #faf8f5;
    --border: #ddd8d0;
    --border-subtle: #e8e4de;
    --accent: #e03000;
    --text: #2a2520;
    --text-strong: #111;
    --dim: #8a8078;
    --dim2: #b0a898;
    --map-bg: #e8e4de;
    --map-land: #d4cfc8;
    --map-land-stroke: #bfb9b0;
    --map-grid: #ddd8d0;
    --green: #007a45;
    --green-glow: #00aa60;
    --nav-bg: rgba(240,237,232,0.94);
    --billboard-bg: #e8e4de;
    --billboard-border: #c0bab2;
    --poe-bg: #f0ede8;
    --feed-hover: #edeae4;
    --feed-selected: #e8e4de;
    --thumb-border: #ccc8c0;
    --scrollbar: #ccc8c0;
    --big-label-color: #ddd8d0;
    --overlay-title: #bfb9b0;
    --logo-color: #111;
  }

  /* ‚îÄ‚îÄ SMOOTH THEME TRANSITIONS ‚îÄ‚îÄ */
  *, *::before, *::after {
    transition:
      background-color 0.3s ease,
      border-color 0.3s ease,
      color 0.3s ease,
      box-shadow 0.3s ease;
  }
  img, canvas, svg, .bb-pin, .bb-pin-dot { transition: none !important; }

  html, body {
    height: 100%;
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Mono', monospace;
    overflow: hidden;
  }

  /* ‚îÄ‚îÄ NAV ‚îÄ‚îÄ */
  nav {
    position: fixed;
    top: 0; left: 0; right: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 24px;
    height: 48px;
    background: var(--nav-bg);
    border-bottom: 1px solid var(--border);
    backdrop-filter: blur(8px);
  }

  .logo {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 22px;
    letter-spacing: 0.12em;
    color: var(--logo-color);
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .logo span { color: var(--accent); }

  .nav-links {
    display: flex;
    gap: 24px;
    list-style: none;
    font-size: 11px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }
  .nav-links a {
    color: var(--dim);
    text-decoration: none;
    transition: color 0.15s;
  }
  .nav-links a:hover { color: var(--text); }

  .nav-right {
    display: flex;
    align-items: center;
    gap: 16px;
    font-size: 11px;
  }
  .submit-btn {
    background: var(--accent);
    color: #fff;
    border: none;
    padding: 6px 14px;
    font-family: 'DM Mono', monospace;
    font-size: 11px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    cursor: pointer;
    transition: opacity 0.15s;
  }
  .submit-btn:hover { opacity: 0.85; }

  /* ‚îÄ‚îÄ LAYOUT ‚îÄ‚îÄ */
  .main-layout {
    display: grid;
    grid-template-columns: 280px 1fr 320px;
    grid-template-rows: 48px 1fr;
    height: 100vh;
    width: 100vw;
  }

  /* ‚îÄ‚îÄ LEFT PANEL: live feed ‚îÄ‚îÄ */
  .feed-panel {
    grid-row: 2;
    grid-column: 1;
    background: var(--surface);
    border-right: 1px solid var(--border);
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  .panel-header {
    padding: 14px 16px 10px;
    border-bottom: 1px solid var(--border);
    font-size: 10px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--dim);
    display: flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0;
  }
  .live-dot {
    width: 6px; height: 6px;
    background: var(--green);
    border-radius: 50%;
    box-shadow: 0 0 6px var(--green);
    animation: pulse 1.8s ease-in-out infinite;
  }
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
  }

  .feed-list {
    overflow-y: auto;
    flex: 1;
    scrollbar-width: thin;
    scrollbar-color: var(--scrollbar) transparent;
  }

  .feed-item {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    padding: 10px 14px;
    border-bottom: 1px solid var(--border-subtle);
    cursor: pointer;
    transition: background 0.1s;
    animation: slideIn 0.4s ease;
  }
  @keyframes slideIn {
    from { opacity: 0; transform: translateY(-8px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .feed-item:hover { background: var(--feed-hover); }

  .feed-punk-thumb {
    width: 36px; height: 36px;
    image-rendering: pixelated;
    flex-shrink: 0;
    border: 1px solid var(--thumb-border);
  }

  .feed-meta {
    flex: 1;
    min-width: 0;
  }
  .feed-punk-id {
    font-size: 12px;
    font-weight: 500;
    color: var(--text-strong);
    white-space: nowrap;
  }
  .feed-location {
    font-size: 10px;
    color: var(--dim);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin-top: 2px;
  }
  .feed-time {
    font-size: 9px;
    color: var(--dim2);
    margin-top: 3px;
  }

  .poe-badge {
    font-size: 9px;
    padding: 2px 6px;
    border: 1px solid var(--accent);
    color: var(--accent);
    letter-spacing: 0.08em;
    flex-shrink: 0;
    margin-top: 4px;
  }

  /* ‚îÄ‚îÄ MAP CENTER ‚îÄ‚îÄ */
  .map-panel {
    grid-row: 2;
    grid-column: 2;
    position: relative;
    overflow: hidden;
    background: var(--map-bg);
  }

  .map-container {
    width: 100%;
    height: 100%;
    position: relative;
  }

  /* Leaflet Map */
  #leaflet-map {
    width: 100%;
    height: 100%;
    background: var(--map-bg);
  }

  /* Dark tile filter for dark theme */
  html:not(.light) .leaflet-tile {
    filter: brightness(0.55) saturate(0.4) hue-rotate(180deg) invert(1);
  }
  /* Light theme ‚Äì natural tiles, slightly desaturated */
  html.light .leaflet-tile {
    filter: saturate(0.6) brightness(0.95);
  }

  /* Hide Leaflet attribution branding (keep OSM credit) */
  .leaflet-control-attribution {
    background: rgba(10,10,10,0.7) !important;
    color: #444 !important;
    font-family: 'DM Mono', monospace !important;
    font-size: 8px !important;
    letter-spacing: 0.05em;
    border-radius: 0 !important;
  }
  .leaflet-control-attribution a { color: #555 !important; }

  /* Zoom control styling */
  .leaflet-control-zoom a {
    background: var(--surface) !important;
    color: var(--text) !important;
    border-color: var(--border) !important;
    font-family: 'DM Mono', monospace !important;
    width: 24px !important;
    height: 24px !important;
    line-height: 24px !important;
    font-size: 16px !important;
  }
  .leaflet-control-zoom a:hover {
    background: var(--feed-hover) !important;
    color: var(--text-strong) !important;
  }
  .leaflet-control-zoom {
    border: 1px solid var(--border) !important;
    border-radius: 0 !important;
    box-shadow: none !important;
  }

  .map-overlay-title {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    font-family: 'Bebas Neue', sans-serif;
    font-size: 11px;
    letter-spacing: 0.3em;
    color: var(--overlay-title);
    pointer-events: none;
    white-space: nowrap;
  }

  /* map grid lines ‚Äî removed (Leaflet handles map rendering) */

  /* ‚îÄ‚îÄ RIGHT PANEL: detail ‚îÄ‚îÄ */
  .detail-panel {
    grid-row: 2;
    grid-column: 3;
    background: var(--surface);
    border-left: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .detail-empty {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 24px;
    text-align: center;
  }
  .detail-empty .big-label {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 32px;
    letter-spacing: 0.1em;
    color: var(--big-label-color);
    line-height: 1;
  }
  .detail-empty p {
    font-size: 11px;
    color: var(--dim);
    line-height: 1.7;
  }

  .detail-content {
    display: none;
    flex-direction: column;
    height: 100%;
  }
  .detail-content.active { display: flex; }

  .detail-img-wrap {
    position: relative;
    background: var(--map-bg);
    border-bottom: 1px solid var(--border);
    padding: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Simulated billboard */
  .billboard-sim {
    position: relative;
    width: 100%;
    max-width: 260px;
  }
  .billboard-frame {
    background: var(--billboard-bg);
    border: 3px solid var(--billboard-border);
    border-radius: 2px;
    padding: 3px;
    position: relative;
  }
  .billboard-frame::before {
    content: '';
    display: block;
    width: 40%;
    height: 6px;
    background: var(--border);
    margin: 0 auto 3px;
    border-radius: 3px 3px 0 0;
  }
  .billboard-screen {
    width: 100%;
    aspect-ratio: 16/9;
    background: var(--map-bg);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
  }
  .billboard-punk {
    image-rendering: pixelated;
    height: 80%;
    width: auto;
    filter: brightness(1.1) contrast(1.05);
  }
  .billboard-glow {
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse at center, rgba(255,60,0,0.15) 0%, transparent 70%);
    pointer-events: none;
  }
  .billboard-pole {
    width: 8px;
    height: 30px;
    background: var(--border);
    margin: 0 auto;
  }
  .billboard-base {
    width: 40px;
    height: 5px;
    background: var(--border-subtle);
    margin: 0 auto;
    border-radius: 2px;
  }

  .detail-info {
    padding: 16px;
    flex: 1;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: var(--scrollbar) transparent;
  }

  .detail-punk-name {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 28px;
    letter-spacing: 0.08em;
    color: var(--text-strong);
    line-height: 1;
  }

  .detail-loc {
    font-size: 11px;
    color: var(--dim);
    margin-top: 4px;
    margin-bottom: 14px;
  }

  .poe-block {
    background: var(--poe-bg);
    border: 1px solid var(--border);
    padding: 12px;
    margin-bottom: 14px;
  }
  .poe-title {
    font-size: 9px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--accent);
    margin-bottom: 8px;
  }
  .poe-row {
    display: flex;
    justify-content: space-between;
    font-size: 10px;
    color: var(--dim);
    padding: 3px 0;
    border-bottom: 1px solid var(--border-subtle);
  }
  .poe-row:last-child { border-bottom: none; }
  .poe-row span { color: var(--text); }

  .poe-verified {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: 10px;
    color: var(--green);
    margin-top: 10px;
  }

  .proof-photo-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 4px;
    margin-top: 12px;
  }
  .proof-photo {
    aspect-ratio: 16/9;
    background: var(--poe-bg);
    border: 1px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 9px;
    color: var(--dim2);
    letter-spacing: 0.1em;
    cursor: pointer;
    overflow: hidden;
    position: relative;
  }
  .proof-photo canvas {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    opacity: 0.5;
  }
  .proof-photo span { position: relative; z-index: 1; }

  .attr-list {
    margin-top: 12px;
  }
  .attr-tag {
    display: inline-block;
    font-size: 9px;
    padding: 3px 8px;
    border: 1px solid var(--border);
    color: var(--dim);
    margin: 2px 2px 2px 0;
    letter-spacing: 0.05em;
  }

  .detail-actions {
    padding: 12px 16px;
    border-top: 1px solid var(--border);
    display: flex;
    gap: 8px;
    flex-shrink: 0;
  }
  .btn-outline {
    flex: 1;
    background: none;
    border: 1px solid var(--border);
    color: var(--dim);
    font-family: 'DM Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 8px;
    cursor: pointer;
    transition: all 0.15s;
  }
  .btn-outline:hover { border-color: var(--text); color: var(--text); }
  .btn-primary {
    flex: 1;
    background: var(--accent);
    border: 1px solid var(--accent);
    color: #fff;
    font-family: 'DM Mono', monospace;
    font-size: 10px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 8px;
    cursor: pointer;
    transition: opacity 0.15s;
  }
  .btn-primary:hover { opacity: 0.85; }

  /* ‚îÄ‚îÄ STATS BAR ‚îÄ‚îÄ */
  .stats-bar {
    grid-row: 1;
    grid-column: 1 / 4;
    display: none; /* hidden, nav takes this row */
  }

  /* counter on map */
  .map-counters {
    position: absolute;
    top: 16px;
    left: 16px;
    display: flex;
    gap: 16px;
    pointer-events: none;
  }
  .counter-pill {
    background: var(--nav-bg);
    border: 1px solid var(--border);
    padding: 5px 12px;
    font-size: 10px;
    letter-spacing: 0.1em;
    color: var(--dim);
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .counter-pill strong { color: var(--text); font-weight: 500; }

  /* ‚îÄ‚îÄ SUBMIT MODAL ‚îÄ‚îÄ */
  .modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.7);
    z-index: 200;
    display: none;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(4px);
  }
  .modal-overlay.open { display: flex; }

  .modal {
    background: var(--surface);
    border: 1px solid var(--border);
    width: 480px;
    max-width: 90vw;
    max-height: 90vh;
    overflow-y: auto;
    scrollbar-width: thin;
  }

  .modal-header {
    padding: 20px 24px 14px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .modal-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 22px;
    letter-spacing: 0.1em;
  }
  .modal-close {
    background: none;
    border: none;
    color: var(--dim);
    font-size: 20px;
    cursor: pointer;
    line-height: 1;
  }
  .modal-close:hover { color: var(--text); }

  .modal-body {
    padding: 20px 24px;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .field-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }
  .field-label {
    font-size: 10px;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--dim);
  }
  .field-input {
    background: var(--poe-bg);
    border: 1px solid var(--border);
    color: var(--text);
    font-family: 'DM Mono', monospace;
    font-size: 12px;
    padding: 8px 10px;
    outline: none;
    transition: border-color 0.15s;
    width: 100%;
  }
  .field-input:focus { border-color: var(--accent); }

  .upload-zone {
    border: 1px dashed var(--dim2);
    padding: 24px;
    text-align: center;
    cursor: pointer;
    transition: border-color 0.15s;
    font-size: 11px;
    color: var(--dim);
    line-height: 1.8;
  }
  .upload-zone:hover { border-color: var(--dim); }

  .modal-footer {
    padding: 14px 24px;
    border-top: 1px solid var(--border);
    display: flex;
    gap: 8px;
    justify-content: flex-end;
  }

  /* ‚îÄ‚îÄ LEAFLET CUSTOM TOOLTIP ‚îÄ‚îÄ */
  .pb2-tooltip {
    background: rgba(10,10,10,0.92) !important;
    border: 1px solid #1e1e1e !important;
    border-radius: 0 !important;
    box-shadow: none !important;
    padding: 5px 10px !important;
    color: #d4d4d4 !important;
    font-family: 'DM Mono', monospace !important;
    font-size: 11px !important;
  }
  .pb2-tooltip::before { display: none !important; }
  html.light .pb2-tooltip {
    background: rgba(250,248,245,0.95) !important;
    border-color: #ddd8d0 !important;
    color: #2a2520 !important;
  }

  /* scrollbar styles */
  ::-webkit-scrollbar { width: 4px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: var(--scrollbar); border-radius: 2px; }

  /* ‚îÄ‚îÄ THEME TOGGLE ‚îÄ‚îÄ */
  .theme-toggle {
    background: none;
    border: 1px solid var(--border);
    color: var(--dim);
    font-family: 'DM Mono', monospace;
    font-size: 14px;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: border-color 0.15s, color 0.15s, transform 0.3s ease;
    flex-shrink: 0;
  }
  .theme-toggle:hover {
    border-color: var(--text);
    color: var(--text);
  }
  .theme-toggle:active { transform: rotate(20deg); }

  /* SVG map variables kept for any future use */

</style>
</head>
<body>

<!-- NAV -->
<nav>
  <div class="logo">pb2<span>.</span>io</div>
  <ul class="nav-links">
    <li><a href="#">map</a></li>
    <li><a href="#">exhibitions</a></li>
    <li><a href="#">punks</a></li>
    <li><a href="#">poe archive</a></li>
    <li><a href="#">about</a></li>
  </ul>
  <div class="nav-right">
    <button class="theme-toggle" id="themeToggle" title="Toggle light/dark theme">‚òÄ</button>
    <button class="submit-btn" onclick="openModal()">+ submit exhibition</button>
  </div>
</nav>

<!-- MAIN LAYOUT -->
<div class="main-layout">

  <!-- LEFT: LIVE FEED -->
  <aside class="feed-panel">
    <div class="panel-header">
      <div class="live-dot"></div>
      recent exhibitions
    </div>
    <div class="feed-list" id="feedList"></div>
  </aside>

  <!-- CENTER: MAP -->
  <main class="map-panel">
    <div class="map-container">
      <div id="leaflet-map"></div>

      <!-- Counters -->
      <div class="map-counters">
        <div class="counter-pill"><strong id="totalCount">0</strong> exhibitions</div>
        <div class="counter-pill"><strong id="countryCount">0</strong> countries</div>
        <div class="counter-pill"><strong id="poeCount">0</strong> POEs verified</div>
      </div>

      <div class="map-overlay-title">pb2.io ‚Äî punks on billboards worldwide</div>
    </div>
  </main>

  <!-- RIGHT: DETAIL -->
  <aside class="detail-panel">
    <div class="panel-header">
      exhibition detail
    </div>
    <div class="detail-empty" id="detailEmpty">
      <div class="big-label">SELECT<br>A PUNK</div>
      <p>Click any pin on the map or<br>an item in the feed to view<br>exhibition details & POE.</p>
    </div>
    <div class="detail-content" id="detailContent">
      <div class="detail-img-wrap">
        <div class="billboard-sim">
          <div class="billboard-frame">
            <div class="billboard-screen">
              <img id="punkImg" class="billboard-punk" alt="CryptoPunk" style="image-rendering:pixelated;height:80%;width:auto;" />
              <div class="billboard-glow"></div>
            </div>
          </div>
          <div class="billboard-pole"></div>
          <div class="billboard-base"></div>
        </div>
      </div>
      <div class="detail-info">
        <div class="detail-punk-name" id="detailPunkName">PUNK #0000</div>
        <div class="detail-loc" id="detailLoc">üìç ‚Äî</div>

        <div class="poe-block">
          <div class="poe-title">Proof of Exhibition</div>
          <div class="poe-row">Date <span id="poeDate">‚Äî</span></div>
          <div class="poe-row">Country <span id="poeCountry">‚Äî</span></div>
          <div class="poe-row">Billboard <span id="poeBillboard">‚Äî</span></div>
          <div class="poe-row">Duration <span id="poeDuration">‚Äî</span></div>
          <div class="poe-row">Operator <span id="poeOperator">‚Äî</span></div>
          <div class="poe-row">TX Hash <span id="poeTx" style="font-size:9px;color:#555">‚Äî</span></div>
          <div class="poe-verified" id="poeVerified">
            <div class="live-dot" style="background:var(--green)"></div>
            POE Verified On-Chain
          </div>
        </div>

        <div style="font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:var(--dim);margin-bottom:6px;">Proof Photos</div>
        <div class="proof-photo-grid" id="proofGrid"></div>

        <div class="attr-list" id="attrList"></div>
      </div>
      <div class="detail-actions">
        <button class="btn-outline">Share</button>
        <button class="btn-primary">Mint POE</button>
      </div>
    </div>
  </aside>

</div>

<!-- SUBMIT MODAL -->
<div class="modal-overlay" id="modalOverlay" onclick="closeModalOut(event)">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title">Submit Exhibition</div>
      <button class="modal-close" onclick="closeModal()">√ó</button>
    </div>
    <div class="modal-body">
      <div style="font-size:11px;color:var(--dim);line-height:1.7;">
        Submit your CryptoPunk billboard exhibition to be verified and archived globally. All submissions are reviewed and issued a Proof of Exhibition (POE).
      </div>
      <div class="field-group">
        <div class="field-label">CryptoPunk ID</div>
        <input class="field-input" type="text" placeholder="e.g. 3100" />
      </div>
      <div class="field-group">
        <div class="field-label">Wallet Address (owner verification)</div>
        <input class="field-input" type="text" placeholder="0x..." />
      </div>
      <div class="field-group">
        <div class="field-label">Billboard Location</div>
        <input class="field-input" type="text" placeholder="City, Country" />
      </div>
      <div class="field-group">
        <div class="field-label">Billboard Operator / Vendor</div>
        <input class="field-input" type="text" placeholder="e.g. Clear Channel, Lamar, independent" />
      </div>
      <div class="field-group">
        <div class="field-label">Exhibition Dates</div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;">
          <input class="field-input" type="date" />
          <input class="field-input" type="date" />
        </div>
      </div>
      <div class="field-group">
        <div class="field-label">Proof Photos (min. 2 required)</div>
        <div class="upload-zone">
          Drop photos here or click to upload<br>
          <span style="font-size:9px;color:#333">JPG, PNG ¬∑ Max 10MB each ¬∑ GPS metadata appreciated</span>
        </div>
      </div>
      <div class="field-group">
        <div class="field-label">Additional Notes</div>
        <textarea class="field-input" rows="3" style="resize:vertical;"></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-outline" onclick="closeModal()" style="flex:none;padding:8px 18px;">Cancel</button>
      <button class="btn-primary" style="flex:none;padding:8px 18px;">Submit for Review</button>
    </div>
  </div>
</div>

<script>
// ‚îÄ‚îÄ DATA ‚îÄ‚îÄ
// Countries in network (from Artcrush x NEORT pitch deck):
// Japan (1000 screens), India (4000), Germany (3000), Netherlands (2810),
// Indonesia (1000), Belgium (750), Finland (700), Spain & Portugal (500),
// England (460), Romania (140), Jordan (100), South Africa (45), Italy (14)
// 17,500+ screens across 11 countries, scaling to 20,000+ by end of 2026

const EXHIBITIONS = [
  // ‚îÄ‚îÄ JAPAN ‚îÄ‚îÄ
  { id: 1,  punk: 7804, loc: "Miyashita Park, Shibuya, Tokyo, Japan",       city: "Tokyo",       country: "Japan",        date: "2026-01-10", billboard: "NEORT / Miyashita Park (34 screens)",        duration: "2 weeks",  operator: "NEORT x Artcrush",      tx: "0x4d1a...c82e", verified: true,  attrs: ["Alien", "Cap Forward", "Small Shades", "Pipe"], mapX: 808, mapY: 118 },
  { id: 2,  punk: 3100, loc: "Toranomon Hills NODE, Tokyo, Japan",           city: "Tokyo",       country: "Japan",        date: "2026-09-15", billboard: "NEORT / Tokyo NODE (5 screens)",             duration: "1 week",   operator: "NEORT x ETH Global",    tx: "0x3f8b...a21d", verified: true,  attrs: ["Alien", "Headband"],                            mapX: 812, mapY: 122 },
  { id: 3,  punk: 9527, loc: "Ikebukuro Station, Tokyo, Japan",              city: "Tokyo",       country: "Japan",        date: "2025-11-20", billboard: "NEORT / Ikebukuro Digital",                  duration: "72hrs",    operator: "@danpolko",             tx: "0x7c2e...1f4a", verified: true,  attrs: ["Male", "Knitted Cap", "Pipe"],                  mapX: 810, mapY: 115 },

  // ‚îÄ‚îÄ INDIA ‚îÄ‚îÄ
  { id: 4,  punk: 2560, loc: "Cyber City, Gurugram, India",                  city: "Gurugram",    country: "India",        date: "2026-02-14", billboard: "Artcrush / Cyber City Hub",                  duration: "1 week",   operator: "Artcrush India",        tx: "0x9a3c...7b1e", verified: true,  attrs: ["Male", "Headband", "Big Shades"],               mapX: 625, mapY: 152 },
  { id: 5,  punk: 8348, loc: "Connaught Place, New Delhi, India",            city: "New Delhi",   country: "India",        date: "2026-02-18", billboard: "Artcrush / CP Digital Wall",                 duration: "5 days",   operator: "Artcrush India",        tx: "0xb4d7...2c9f", verified: true,  attrs: ["Female", "Crazy Hair", "Purple Eye Shadow"],    mapX: 618, mapY: 148 },
  { id: 6,  punk: 5217, loc: "Bandra-Kurla Complex, Mumbai, India",          city: "Mumbai",      country: "India",        date: "2026-03-01", billboard: "Artcrush / BKC Screens",                     duration: "4 days",   operator: "Artcrush India",        tx: "0xe1f2...4a8d", verified: false, attrs: ["Female", "Wild Blonde", "Earring"],             mapX: 614, mapY: 162 },

  // ‚îÄ‚îÄ GERMANY ‚îÄ‚îÄ
  { id: 7,  punk: 42,   loc: "Alexanderplatz, Berlin, Germany",             city: "Berlin",      country: "Germany",      date: "2025-12-05", billboard: "Str√∂er / Alexanderplatz",                    duration: "48hrs",    operator: "Artcrush x Str√∂er",     tx: "0xf7d2...1b9a", verified: true,  attrs: ["Male", "Frumpy Hair", "Chinstrap"],             mapX: 468, mapY: 80 },
  { id: 8,  punk: 1190, loc: "Hauptbahnhof, Munich, Germany",               city: "Munich",      country: "Germany",      date: "2025-12-20", billboard: "APG|SGA / M√ºnchen Hbf",                     duration: "120hrs",   operator: "ETH Z√ºrich Crypto Art", tx: "0x3a8d...e6f1", verified: true,  attrs: ["Male", "Do-rag", "3D Glasses"],                 mapX: 471, mapY: 85 },
  { id: 9,  punk: 4156, loc: "Cologne Cathedral Square, Germany",           city: "Cologne",     country: "Germany",      date: "2026-01-15", billboard: "Str√∂er / K√∂ln Dom",                          duration: "36hrs",    operator: "Artcrush Germany",      tx: "0x2c7a...9e3f", verified: false, attrs: ["Ape", "Police Cap", "Pipe"],                    mapX: 461, mapY: 82 },

  // ‚îÄ‚îÄ NETHERLANDS ‚îÄ‚îÄ
  { id: 10, punk: 6529, loc: "Rotterdam Centraal, Netherlands",             city: "Rotterdam",   country: "Netherlands",  date: "2025-11-28", billboard: "Artcrush / Rotterdam Centraal (Linda Dounia)", duration: "1 week",   operator: "Artcrush x NS Media",   tx: "0x5e9c...3d7b", verified: true,  attrs: ["Female", "Tiara", "Purple Eye Shadow"],         mapX: 448, mapY: 82 },
  { id: 11, punk: 2890, loc: "Leidseplein, Amsterdam, Netherlands",         city: "Amsterdam",   country: "Netherlands",  date: "2026-01-22", billboard: "JCDecaux / Leidseplein",                     duration: "72hrs",    operator: "Punk #2890 owner",      tx: "0xb3e7...0d5f", verified: false, attrs: ["Male", "Cap", "Nerd Glasses"],                  mapX: 446, mapY: 80 },

  // ‚îÄ‚îÄ INDONESIA ‚îÄ‚îÄ
  { id: 12, punk: 9918, loc: "Sudirman CBD, Jakarta, Indonesia",            city: "Jakarta",     country: "Indonesia",    date: "2026-02-05", billboard: "Artcrush / Sudirman Digital Tower",          duration: "5 days",   operator: "@dxbcryptopunk",        tx: "0x6b1c...d4e8", verified: true,  attrs: ["Female", "Red Mohawk", "Clown Eyes Green"],     mapX: 726, mapY: 213 },
  { id: 13, punk: 3831, loc: "Seminyak, Bali, Indonesia",                   city: "Bali",        country: "Indonesia",    date: "2026-02-12", billboard: "Artcrush / Bali Digital Hub",                duration: "48hrs",    operator: "Artcrush SEA",          tx: "0x7d3f...c12a", verified: false, attrs: ["Male", "Mohawk Dark", "Horned Rim Glasses"],    mapX: 734, mapY: 220 },

  // ‚îÄ‚îÄ BELGIUM ‚îÄ‚îÄ
  { id: 14, punk: 5822, loc: "Grand Place, Brussels, Belgium",              city: "Brussels",    country: "Belgium",      date: "2025-12-15", billboard: "Artcrush / Grand Place Digital",             duration: "60hrs",    operator: "Artcrush Belgium",      tx: "0xc1d8...7b2a", verified: true,  attrs: ["Male", "Mohawk Dark", "Eye Patch"],             mapX: 448, mapY: 84 },
  { id: 15, punk: 7252, loc: "Antwerp Central Station, Belgium",            city: "Antwerp",     country: "Belgium",      date: "2026-01-18", billboard: "Artcrush / Antwerp Centraal",                duration: "3 days",   operator: "Artcrush Belgium",      tx: "0xa2e5...8f1c", verified: false, attrs: ["Zombie", "Wild Hair"],                          mapX: 446, mapY: 83 },

  // ‚îÄ‚îÄ FINLAND ‚îÄ‚îÄ
  { id: 16, punk: 1422, loc: "Kamppi Centre, Helsinki, Finland",            city: "Helsinki",    country: "Finland",      date: "2026-01-08", billboard: "Artcrush / Kamppi Digital",                  duration: "4 days",   operator: "Artcrush Nordic",       tx: "0xd4b9...5e2c", verified: true,  attrs: ["Female", "Straight Hair Dark", "Earring"],     mapX: 482, mapY: 60 },
  { id: 17, punk: 8765, loc: "Rautatientori, Helsinki, Finland",            city: "Helsinki",    country: "Finland",      date: "2026-02-22", billboard: "JCDecaux / Helsinki Railway Square",         duration: "48hrs",    operator: "Artcrush Nordic",       tx: "0xf3a1...7d4b", verified: false, attrs: ["Male", "Cap", "Big Shades"],                    mapX: 484, mapY: 58 },

  // ‚îÄ‚îÄ SPAIN ‚îÄ‚îÄ
  { id: 18, punk: 635,  loc: "Puerta del Sol, Madrid, Spain",               city: "Madrid",      country: "Spain",        date: "2025-12-18", billboard: "Artcrush / Sol Digital",                     duration: "4 days",   operator: "Artcrush Iberia",       tx: "0xe9a2...4c1b", verified: true,  attrs: ["Female", "Wild Blonde", "Purple Eye Shadow"],  mapX: 427, mapY: 100 },
  { id: 19, punk: 4464, loc: "La Rambla, Barcelona, Spain",                 city: "Barcelona",   country: "Spain",        date: "2026-01-25", billboard: "JCDecaux / Las Ramblas",                     duration: "3 days",   operator: "Artcrush Iberia",       tx: "0x1b8d...f3a9", verified: false, attrs: ["Male", "Fedora", "Nerd Glasses"],               mapX: 438, mapY: 99 },

  // ‚îÄ‚îÄ PORTUGAL ‚îÄ‚îÄ
  { id: 20, punk: 2243, loc: "Marqu√™s de Pombal, Lisbon, Portugal",         city: "Lisbon",      country: "Portugal",     date: "2026-02-10", billboard: "Artcrush / Marqu√™s Digital",                 duration: "72hrs",    operator: "Artcrush Iberia",       tx: "0x8c4f...2e1d", verified: true,  attrs: ["Female", "Mohawk Thin", "Hot Lipstick"],        mapX: 418, mapY: 101 },

  // ‚îÄ‚îÄ ENGLAND ‚îÄ‚îÄ
  { id: 21, punk: 8348, loc: "Piccadilly Circus, London, England",          city: "London",      country: "England",      date: "2025-12-08", billboard: "Ocean Outdoor / Piccadilly Lights",          duration: "24hrs",    operator: "CryptoPunks London",    tx: "0x9f2c...1a4d", verified: true,  attrs: ["Female", "Crazy Hair", "Purple Eye Shadow"],   mapX: 403, mapY: 83 },
  { id: 22, punk: 6965, loc: "Piccadilly Circus, London, England",          city: "London",      country: "England",      date: "2026-01-30", billboard: "Ocean Outdoor / Piccadilly Lights",          duration: "48hrs",    operator: "@ekaitza.eth",          tx: "0x4a6e...9c3d", verified: true,  attrs: ["Ape", "Fedora"],                               mapX: 404, mapY: 84 },
  { id: 23, punk: 3443, loc: "Manchester Piccadilly, England",              city: "Manchester",  country: "England",      date: "2026-02-20", billboard: "Artcrush / Manchester Piccadilly",           duration: "3 days",   operator: "Artcrush UK",           tx: "0x2d9b...e5f7", verified: false, attrs: ["Male", "Stringy Tailed Hair", "Earring"],      mapX: 401, mapY: 80 },

  // ‚îÄ‚îÄ ROMANIA ‚îÄ‚îÄ
  { id: 24, punk: 5831, loc: "Movieplex Mall, Bucharest, Romania",          city: "Bucharest",   country: "Romania",      date: "2025-10-14", billboard: "Artcrush / Movieplex Bucharest",             duration: "1 week",   operator: "Artcrush x ALPER",      tx: "0x6e2c...b8a1", verified: true,  attrs: ["Male", "Mohawk Dark", "Regular Shades"],       mapX: 492, mapY: 89 },
  { id: 25, punk: 9082, loc: "Floreasca City Center, Bucharest, Romania",   city: "Bucharest",   country: "Romania",      date: "2026-01-12", billboard: "Artcrush / Floreasca Digital",               duration: "5 days",   operator: "Artcrush Romania",      tx: "0x3f7d...c4b2", verified: false, attrs: ["Female", "Blonde Bob", "Green Eye Shadow"],    mapX: 493, mapY: 90 },

  // ‚îÄ‚îÄ JORDAN ‚îÄ‚îÄ
  { id: 26, punk: 7121, loc: "Abdali Boulevard, Amman, Jordan",             city: "Amman",       country: "Jordan",       date: "2026-02-08", billboard: "Artcrush / Abdali Digital Walk",             duration: "4 days",   operator: "Artcrush MENA",         tx: "0x5c8a...1f3e", verified: true,  attrs: ["Male", "Hoodie", "VR"],                        mapX: 524, mapY: 135 },

  // ‚îÄ‚îÄ SOUTH AFRICA ‚îÄ‚îÄ
  { id: 27, punk: 4930, loc: "V&A Waterfront, Cape Town, South Africa",     city: "Cape Town",   country: "South Africa", date: "2026-01-20", billboard: "Artcrush / Waterfront Digital",              duration: "3 days",   operator: "Artcrush Africa",       tx: "0x9e1b...d7c4", verified: true,  attrs: ["Female", "Tassle Hat", "Hot Lipstick"],        mapX: 470, mapY: 352 },

  // ‚îÄ‚îÄ ITALY ‚îÄ‚îÄ
  { id: 28, punk: 2046, loc: "Piazza del Duomo, Milan, Italy",              city: "Milan",       country: "Italy",        date: "2026-03-05", billboard: "Artcrush / Duomo Digital",                   duration: "48hrs",    operator: "Artcrush Italy",        tx: "0xc7f3...8a2e", verified: false, attrs: ["Male", "Peak Spike Hair", "Big Shades"],       mapX: 462, mapY: 92 },
];

// ‚îÄ‚îÄ PUNK IMAGE VIA PUNKS.ART API ‚îÄ‚îÄ
// Returns the URL for a real CryptoPunk PNG image
function punkImgUrl(punkId, size = 100) {
  return `https://punks.art/api/punks/${punkId}?format=png&size=${size}&background=punk`;
}

// Sets an <img> element to show the real punk, with pixelated rendering
function setPunkImg(imgEl, punkId, size = 100) {
  imgEl.src = punkImgUrl(punkId, size);
  imgEl.style.imageRendering = 'pixelated';
  imgEl.style.width = '100%';
  imgEl.style.height = '100%';
  imgEl.style.objectFit = 'contain';
}

// Legacy shim ‚Äî canvas elements are replaced by <img> in feed + detail
function drawPunk(canvas, punkId, attrs) {
  // no-op: replaced by real images
}

// ‚îÄ‚îÄ LEAFLET MAP ‚îÄ‚îÄ
// Add real lat/lng to exhibitions (mapped from pitch deck locations)
const LAT_LNG = {
  1:  [35.6580, 139.7016],  // Miyashita Park, Shibuya
  2:  [35.6671, 139.7491],  // Toranomon Hills
  3:  [35.7295, 139.7109],  // Ikebukuro
  4:  [28.4949, 77.0910],   // Gurugram
  5:  [28.6139, 77.2090],   // New Delhi
  6:  [19.0596, 72.8295],   // Mumbai BKC
  7:  [52.5200, 13.4050],   // Berlin Alexanderplatz
  8:  [48.1402, 11.5600],   // Munich Hbf
  9:  [50.9384, 6.9570],    // Cologne Dom
  10: [51.9226, 4.4792],    // Rotterdam Centraal
  11: [52.3641, 4.9006],    // Amsterdam Leidseplein
  12: [-6.2088, 106.8456],  // Jakarta Sudirman
  13: [-8.6705, 115.2126],  // Bali Seminyak
  14: [50.8467, 4.3517],    // Brussels Grand Place
  15: [51.2167, 4.4210],    // Antwerp Centraal
  16: [60.1699, 24.9384],   // Helsinki Kamppi
  17: [60.1719, 24.9414],   // Helsinki Rautatientori
  18: [40.4168, -3.7038],   // Madrid Puerta del Sol
  19: [41.3810, 2.1734],    // Barcelona La Rambla
  20: [38.7169, -9.1399],   // Lisbon Marqu√™s
  21: [51.5098, -0.1342],   // London Piccadilly
  22: [51.5098, -0.1342],   // London Piccadilly (offset below)
  23: [53.4808, -2.2426],   // Manchester Piccadilly
  24: [44.4268, 26.1025],   // Bucharest Movieplex
  25: [44.4550, 26.0850],   // Bucharest Floreasca
  26: [31.9522, 35.9312],   // Amman Abdali
  27: [-33.9015, 18.4200],  // Cape Town V&A
  28: [45.4641, 9.1908],    // Milan Duomo
};

// Attach lat/lng to each exhibition
EXHIBITIONS.forEach(ex => {
  if (LAT_LNG[ex.id]) {
    ex.lat = LAT_LNG[ex.id][0];
    ex.lng = LAT_LNG[ex.id][1];
  }
});

// Slight offset for co-located pins (same venue, different punks)
const OFFSETS = { 22: [0.0008, 0.0008], 17: [0.001, 0.001], 25: [0.003, 0.003] };

// Init Leaflet
const leafletMap = L.map('leaflet-map', {
  center: [30, 20],
  zoom: 2,
  minZoom: 2,
  maxZoom: 16,
  zoomControl: true,
  attributionControl: true,
  worldCopyJump: true,
});

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
  maxZoom: 19,
}).addTo(leafletMap);

// Custom SVG marker factory
function makeMarkerIcon(verified) {
  const color = verified ? '#00cc70' : '#ff3c00';
  const glow = verified ? '#00ff88' : '#ff3c00';
  const svg = `
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="32" viewBox="0 0 24 32">
      <circle cx="12" cy="10" r="8" fill="${color}" opacity="0.18"/>
      <circle cx="12" cy="10" r="5" fill="${color}" filter="drop-shadow(0 0 4px ${glow})"/>
      <line x1="12" y1="15" x2="12" y2="28" stroke="${color}" stroke-width="1.5" opacity="0.6"/>
    </svg>`;
  return L.divIcon({
    html: svg,
    className: '',
    iconSize: [24, 32],
    iconAnchor: [12, 28],
    popupAnchor: [0, -28],
  });
}

// Add markers
const leafletMarkers = {};
EXHIBITIONS.forEach(ex => {
  if (!ex.lat || !ex.lng) return;
  const offset = OFFSETS[ex.id] || [0, 0];
  const latlng = [ex.lat + offset[0], ex.lng + offset[1]];

  const marker = L.marker(latlng, { icon: makeMarkerIcon(ex.verified) });

  marker.bindTooltip(
    `<span style="font-family:'DM Mono',monospace;font-size:11px;letter-spacing:0.06em"><strong>PUNK #${ex.punk}</strong> ¬∑ ${ex.city}, ${ex.country}</span>`,
    { direction: 'top', offset: [0, -4], className: 'pb2-tooltip' }
  );

  marker.on('click', () => {
    showDetail(ex.id);
    leafletMap.flyTo(latlng, Math.max(leafletMap.getZoom(), 10), { duration: 0.8 });
  });

  marker.addTo(leafletMap);
  leafletMarkers[ex.id] = marker;
});

// ‚îÄ‚îÄ RENDER FEED ‚îÄ‚îÄ
const feedList = document.getElementById('feedList');

function createFeedItem(ex) {
  const div = document.createElement('div');
  div.className = 'feed-item';
  div.dataset.id = ex.id;
  
  const img = document.createElement('img');
  img.className = 'feed-punk-thumb';
  img.style.imageRendering = 'pixelated';
  img.src = punkImgUrl(ex.punk, 36);
  img.alt = `Punk #${ex.punk}`;
  
  const meta = document.createElement('div');
  meta.className = 'feed-meta';
  
  const timeAgo = getTimeAgo(ex.date);
  meta.innerHTML = `
    <div class="feed-punk-id">PUNK #${ex.punk}</div>
    <div class="feed-location">${ex.loc}</div>
    <div class="feed-time">${timeAgo}</div>
  `;
  
  div.appendChild(img);
  div.appendChild(meta);
  
  if (ex.verified) {
    const badge = document.createElement('div');
    badge.className = 'poe-badge';
    badge.textContent = 'POE';
    meta.appendChild(badge);
  }
  
  div.addEventListener('click', () => showDetail(ex.id));
  return div;
}

function getTimeAgo(dateStr) {
  const d = new Date(dateStr);
  const now = new Date('2025-12-25');
  const diff = Math.floor((now - d) / (1000 * 60 * 60 * 24));
  if (diff === 0) return 'today';
  if (diff === 1) return '1 day ago';
  return `${diff} days ago`;
}

// Populate feed (newest first)
const sorted = [...EXHIBITIONS].sort((a,b) => b.id - a.id);
sorted.forEach(ex => feedList.appendChild(createFeedItem(ex)));

// Update counters
document.getElementById('totalCount').textContent = EXHIBITIONS.length;
document.getElementById('countryCount').textContent = new Set(EXHIBITIONS.map(e => e.country)).size;
document.getElementById('poeCount').textContent = EXHIBITIONS.filter(e => e.verified).length;

// ‚îÄ‚îÄ SHOW DETAIL ‚îÄ‚îÄ
function showDetail(id) {
  const ex = EXHIBITIONS.find(e => e.id === id);
  if (!ex) return;
  
  document.getElementById('detailEmpty').style.display = 'none';
  const dc = document.getElementById('detailContent');
  dc.classList.add('active');
  
  // Set real punk image in billboard
  const punkImg = document.getElementById('punkImg');
  punkImg.src = punkImgUrl(ex.punk, 200);
  
  document.getElementById('detailPunkName').textContent = `PUNK #${ex.punk}`;
  document.getElementById('detailLoc').textContent = `üìç ${ex.loc}`;
  document.getElementById('poeDate').textContent = ex.date;
  document.getElementById('poeCountry').textContent = ex.country;
  document.getElementById('poeBillboard').textContent = ex.billboard;
  document.getElementById('poeDuration').textContent = ex.duration;
  document.getElementById('poeOperator').textContent = ex.operator;
  document.getElementById('poeTx').textContent = ex.tx;
  
  const poeVerified = document.getElementById('poeVerified');
  if (ex.verified) {
    poeVerified.style.display = 'flex';
  } else {
    poeVerified.style.display = 'none';
  }
  
  // Proof photos ‚Äî mini billboard scenes with real punk images
  const grid = document.getElementById('proofGrid');
  grid.innerHTML = '';
  const shotLabels = ['street view', 'night shot', 'wide angle', 'close-up'];
  for (let i = 0; i < 4; i++) {
    const div = document.createElement('div');
    div.className = 'proof-photo';
    div.style.position = 'relative';
    div.style.overflow = 'hidden';
    div.style.background = `hsl(${(ex.id * 37 + i * 70) % 360},15%,7%)`;

    // Simulated scene canvas (background atmosphere)
    const c = document.createElement('canvas');
    c.width = 160; c.height = 90;
    const ctx = c.getContext('2d');
    const hue = (ex.id * 37 + i * 70) % 360;
    ctx.fillStyle = `hsl(${hue},15%,6%)`;
    ctx.fillRect(0, 0, 160, 90);
    // atmospheric gradient
    for (let y = 0; y < 90; y++) {
      ctx.globalAlpha = 0.04;
      ctx.fillStyle = `hsl(${hue + 30},40%,${18 + y / 3}%)`;
      ctx.fillRect(0, y, 160, 1);
    }
    ctx.globalAlpha = 1;
    // billboard frame
    ctx.fillStyle = '#0e0e0e';
    ctx.fillRect(42, 12, 76, 44);
    ctx.strokeStyle = '#2a2a2a';
    ctx.lineWidth = 1;
    ctx.strokeRect(42, 12, 76, 44);
    // inner screen glow
    const grd = ctx.createRadialGradient(80, 34, 2, 80, 34, 38);
    grd.addColorStop(0, 'rgba(255,60,0,0.12)');
    grd.addColorStop(1, 'transparent');
    ctx.fillStyle = grd;
    ctx.fillRect(42, 12, 76, 44);
    // pole
    ctx.fillStyle = '#1a1a1a';
    ctx.fillRect(78, 56, 4, 22);
    ctx.fillStyle = '#161616';
    ctx.fillRect(64, 78, 32, 4);
    // noise
    for (let n = 0; n < 300; n++) {
      ctx.fillStyle = `rgba(255,255,255,${Math.random() * 0.025})`;
      ctx.fillRect(Math.random() * 160, Math.random() * 90, 1, 1);
    }
    c.style.position = 'absolute';
    c.style.inset = '0';
    c.style.width = '100%';
    c.style.height = '100%';
    div.appendChild(c);

    // Real punk image inside the billboard
    const punkThumb = document.createElement('img');
    punkThumb.src = punkImgUrl(ex.punk, 48);
    punkThumb.style.cssText = `
      position:absolute;
      left:50px; top:16px;
      width:60px; height:36px;
      object-fit:contain;
      image-rendering:pixelated;
      z-index:2;
    `;
    div.appendChild(punkThumb);

    const label = document.createElement('span');
    label.textContent = shotLabels[i];
    label.style.cssText = 'position:absolute;bottom:4px;right:6px;z-index:3;font-size:8px;color:#333;letter-spacing:0.08em;';
    div.appendChild(label);
    grid.appendChild(div);
  }
  
  // Attributes
  const attrList = document.getElementById('attrList');
  attrList.innerHTML = `<div style="font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:var(--dim);margin-bottom:6px;margin-top:12px;">Attributes</div>`;
  ex.attrs.forEach(a => {
    const span = document.createElement('span');
    span.className = 'attr-tag';
    span.textContent = a;
    attrList.appendChild(span);
  });
  
  // Highlight feed item
  document.querySelectorAll('.feed-item').forEach(el => el.style.background = '');
  const feedItem = document.querySelector(`.feed-item[data-id="${id}"]`);
  if (feedItem) {
    feedItem.style.background = 'var(--feed-selected)';
    feedItem.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }

  // Pan Leaflet map to marker
  if (ex.lat && leafletMarkers[id]) {
    const offset = OFFSETS[id] || [0, 0];
    leafletMap.flyTo([ex.lat + offset[0], ex.lng + offset[1]], Math.max(leafletMap.getZoom(), 10), { duration: 0.8 });
  }
}

// Auto-select first ‚Äî defer so Leaflet tiles have loaded
setTimeout(() => showDetail(1), 300);

// ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ
function openModal() {
  document.getElementById('modalOverlay').classList.add('open');
}
function closeModal() {
  document.getElementById('modalOverlay').classList.remove('open');
}
function closeModalOut(e) {
  if (e.target === document.getElementById('modalOverlay')) closeModal();
}

// ‚îÄ‚îÄ SIMULATE LIVE UPDATES ‚îÄ‚îÄ
let newPunkIds = [9999, 4206, 1111, 5678];
let cityPool = ['Jakarta, Indonesia', 'Chennai, India', 'Rotterdam, Netherlands', 'Bucharest, Romania'];
let countryPool = ['Indonesia', 'India', 'Netherlands', 'Romania'];
let mapXPool = [726, 630, 448, 492];
let mapYPool = [213, 155, 82, 90];
let idx = 0;
setInterval(() => {
  if (idx >= newPunkIds.length) return;
  const fakeEx = {
    id: 100 + idx,
    punk: newPunkIds[idx],
    loc: cityPool[idx % cityPool.length],
    city: cityPool[idx % cityPool.length].split(',')[0],
    country: countryPool[idx % countryPool.length],
    date: '2026-02-23',
    verified: false,
    attrs: [],
  };
  const item = createFeedItem(fakeEx);
  feedList.insertBefore(item, feedList.firstChild);
  item.style.background = '#1a1500';
  setTimeout(() => { item.style.background = ''; }, 2000);
  document.getElementById('totalCount').textContent = EXHIBITIONS.length + idx + 1;
  idx++;
}, 12000);
// ‚îÄ‚îÄ THEME TOGGLE ‚îÄ‚îÄ
const themeToggle = document.getElementById('themeToggle');
const html = document.documentElement;

// Icons
const ICON_DARK = '‚òÄ';   // shown when in dark mode (click to go light)
const ICON_LIGHT = '‚òæ';  // shown when in light mode (click to go dark)

function applyTheme(isLight) {
  if (isLight) {
    html.classList.add('light');
    themeToggle.textContent = ICON_LIGHT;
    themeToggle.title = 'Switch to dark theme';
  } else {
    html.classList.remove('light');
    themeToggle.textContent = ICON_DARK;
    themeToggle.title = 'Switch to light theme';
  }
  // Force tile re-render so CSS filter applies immediately
  if (typeof leafletMap !== 'undefined') {
    setTimeout(() => leafletMap.invalidateSize(), 50);
  }
}

// Load saved preference, fall back to system preference
const saved = localStorage.getItem('pb2-theme');
const prefersLight = window.matchMedia('(prefers-color-scheme: light)').matches;
const startLight = saved ? saved === 'light' : prefersLight;
applyTheme(startLight);

themeToggle.addEventListener('click', () => {
  const goingLight = !html.classList.contains('light');
  applyTheme(goingLight);
  localStorage.setItem('pb2-theme', goingLight ? 'light' : 'dark');
});

</script>
</body>
</html>
